Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Class sizes
p_np 0: 50.00%, 1: 50.00%
Total size = 244,496 | train size = 195,596 | val size = 24,450 | test size = 24,450
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Fold 0
Loading data
Number of tasks = 1
Splitting data with seed 0
Class sizes
p_np 0: 50.00%, 1: 50.00%
Total size = 244,496 | train size = 195,596 | val size = 24,450 | test size = 24,450
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation auc = 0.702711
Epoch 1
Validation auc = 0.734049
Epoch 2
Validation auc = 0.751005
Epoch 3
Validation auc = 0.765603
Epoch 4
Validation auc = 0.771596
Epoch 5
Validation auc = 0.776056
Epoch 6
Validation auc = 0.780332
Epoch 7
Validation auc = 0.787241
Epoch 8
Validation auc = 0.790110
Epoch 9
Validation auc = 0.791185
Epoch 10
Validation auc = 0.792539
Epoch 11
Validation auc = 0.795931
Epoch 12
Validation auc = 0.796003
Epoch 13
Validation auc = 0.791719
Epoch 14
Validation auc = 0.793360
Epoch 15
Validation auc = 0.793983
Epoch 16
Validation auc = 0.792852
Epoch 17
Validation auc = 0.791978
Epoch 18
Validation auc = 0.789267
Epoch 19
Validation auc = 0.787129
Epoch 20
Validation auc = 0.785029
Epoch 21
Validation auc = 0.786566
Epoch 22
Validation auc = 0.781294
Epoch 23
Validation auc = 0.778105
Epoch 24
Validation auc = 0.776920
Epoch 25
Validation auc = 0.778839
Epoch 26
Validation auc = 0.775149
Epoch 27
Validation auc = 0.776445
Epoch 28
Validation auc = 0.774080
Epoch 29
Validation auc = 0.771024
Model 0 best validation auc = 0.796003 on epoch 12
Moving model to cuda
Model 0 test auc = 0.791041
Ensemble test auc = 0.791041
1-fold cross validation
Seed 0 ==> test auc = 0.791041
Overall test auc = 0.791041 +/- 0.000000
